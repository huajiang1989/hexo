<!DOCTYPE html><html><head><title> Webpack与react | Mr.Hua&#39;s Blog</title><link rel="icon shortcut" type="image/ico" href="/img/favicon.png"><link rel="icon" sizes="192x192" href="/img/favicon.png"><link rel="apple-touch-icon" href="/img/favicon.png"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#0097A7"><meta name="author" content="Mr.Hua"><meta name="description" content="About My Work Daily"><meta name="keywords" content="null"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="apple-mobile-web-app-title" content="Title"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="480"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="Mr.Hua&#39;s Blog"><meta property="og:url" content="http://yoursite.com"><meta property="og:type" content="blog"><meta property="og:title" content="Webpack与react | Mr.Hua&#39;s Blog"><meta property="og:description" content="About My Work Daily"><!--[if lte IE 9]><link rel="stylesheet" href="/css/ie-blocker.css"><script src="/js/ie-blocker.en.js"></script><![endif]--><link rel="stylesheet" href="/css/material.min.css"><link rel="stylesheet" href="/css/style.min.css"><style>body,html{font-family:Roboto,"Helvetica Neue",Helvetica,"PingFang SC","Hiragino Sans GB","Microsoft YaHei","微软雅黑",Arial,sans-serif}a{color:#00838F}#scheme-Paradox .hot_tags-count,#scheme-Paradox .sidebar-colored .sidebar-badge,#scheme-Paradox .sidebar-colored .sidebar-header,#scheme-Paradox .sidebar_archives-count,#search-form-label:after,#search-label,.mdl-card__media{background-color:#0097A7!important}#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus,#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover{color:#0097A7!important}#ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a,#post_entry-right-info,.sidebar-colored .sidebar-nav li:hover>a,.sidebar-colored .sidebar-nav li:hover>a i,.sidebar-colored .sidebar-nav li>a:focus i,.sidebar-colored .sidebar-nav li>a:hover,.sidebar-colored .sidebar-nav li>a:hover i,.sidebar-colored .sidebar-nav>.open>a,.sidebar-colored .sidebar-nav>.open>a:focus,.sidebar-colored .sidebar-nav>.open>a:hover{color:#0097A7!important}.toTop{background:#757575!important}.material-layout .material-index>.material-nav,.material-layout .material-post>.material-nav,.material-nav a{color:#757575}#scheme-Paradox .MD-burger-layer{background-color:#757575}#scheme-Paradox #post-toc-trigger-btn{color:#757575}.post-toc a:hover{color:#00838F;text-decoration:underline}</style><style>body{background-color:#F5F5F5}#scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{background-color:#fff}</style><style>.fade{transition:all .8s linear;-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0);opacity:1}.fade.out{opacity:0}</style><script src="/js/jquery.min.js"></script><link rel="stylesheet" href="/css/highlight/obsidian.css"><script>var agent=navigator.userAgent.toLowerCase();agent.indexOf("ucbrowser")>0&&(document.write('<link rel="stylesheet" href="/css/uc.css">'),alert("由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。"))</script></head><body id="scheme-Paradox"><div class="material-layout mdl-js-layout has-drawer is-upgraded"><main class="material-layout__content" id="main"><div id="top"></div> <button class="MD-burger-icon sidebar-toggle"><span class="MD-burger-layer"></span></button> <button id="post-toc-trigger-btn" class="mdl-button mdl-js-button mdl-button--icon"> <i class="material-icons">format_list_numbered</i></button><ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn"><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#webpack特性"><span class="post-toc-number">1.</span> <span class="post-toc-text">webpack特性</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#React-sample"><span class="post-toc-number">2.</span> <span class="post-toc-text">React-sample</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Webpack安装和配置"><span class="post-toc-number">3.</span> <span class="post-toc-text">Webpack安装和配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#安装"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">安装</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#配置"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#entry"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">entry</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#output"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">output</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#module"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">module</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#resolve"><span class="post-toc-number">3.6.</span> <span class="post-toc-text">resolve</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#plugin"><span class="post-toc-number">3.7.</span> <span class="post-toc-text">plugin</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#externals"><span class="post-toc-number">3.8.</span> <span class="post-toc-text">externals</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#context"><span class="post-toc-number">3.9.</span> <span class="post-toc-text">context</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#webpack常用命令"><span class="post-toc-number">4.</span> <span class="post-toc-text">webpack常用命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#webpack的使用通常有三种方式："><span class="post-toc-number">4.1.</span> <span class="post-toc-text">webpack的使用通常有三种方式：</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#图片打包和静态资源服务器"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">图片打包和静态资源服务器</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#图片打包"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">图片打包</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#静态资源服务器"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">静态资源服务器</span></a></li></ol></li></ol></ul><div class="material-post_container"><div class="material-post mdl-grid"><div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col"><div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50"><script>var randomNum;randomNum=Math.floor(5*Math.random()+1),$(".post_thumbnail-random").css("background-image","url(/img/random/"+randomNum+".png)")</script><p class="article-headline-p"> Webpack与react</p></div><div class="mdl-color-text--grey-700 mdl-card__supporting-text meta"><div id="author-avatar"> <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"></div><div> <strong>Mr.Hua</strong> <span>Dec 07, 2016</span></div><div class="section-spacer"></div> <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"> <i class="material-icons" role="presentation">bookmark</i> <span class="visuallyhidden">bookmark</span></button><ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button"><li class="mdl-menu__item"> <a class="post_tag-link" href="/tags/webpack/">webpack</a></li></ul> <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"> <i class="material-icons" role="presentation">share</i> <span class="visuallyhidden">share</span></button><ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button"><a class="post_share-link" href="https://twitter.com/intent/tweet?text=Webpack与react&url=http://yoursite.com//2016/12/07/webpack-react/index.html&via=Mr.Hua" target="_blank"><li class="mdl-menu__item"> شارك على Twitter</li></a><a class="post_share-link" href="https://plus.google.com/share?url=http://yoursite.com//2016/12/07/webpack-react/index.html" target="_blank"><li class="mdl-menu__item"> شارك على Google+</li></a><a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Webpack与react&url=http://yoursite.com//2016/12/07/webpack-react/index.html&pic=&searchPic=false&style=simple" target="_blank"><li class="mdl-menu__item"> شارك على Weibo</li></a></ul></div><div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out"><h1 id="webpack特性"><a href="#webpack特性" class="headerlink" title="webpack特性"></a>webpack特性</h1><p>webpack具有requireJs和browserify的功能，但仍有很多自己的新特性：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">1. 对 CommonJS 、 AMD 、ES6的语法做了兼容</div><div class="line">2. 对js、css、图片等资源文件都支持打包</div><div class="line">3. 串联式模块加载器以及插件机制，让其具有更好的灵活性和扩展性，例如提供对CoffeeScript、ES6的支持</div><div class="line">4. 有独立的配置文件webpack.config.js</div><div class="line">5. 可以将代码切割成不同的chunk，实现按需加载，降低了初始化时间</div><div class="line">6. 支持 SourceUrls 和 SourceMaps，易于调试</div><div class="line">7. 具有强大的Plugin接口，大多是内部插件，使用起来比较灵活</div><div class="line">8.webpack 使用异步 IO 并具有多级缓存。这使得 webpack 很快且在增量编译上更加快</div></pre></td></tr></table></figure><p></p><a id="more"></a><h1 id="React-sample"><a href="#React-sample" class="headerlink" title="React-sample"></a>React-sample</h1><p>以 react-sample 为例，简单说明 webpack 如何打包一个 React 组件，其目录结构如下：</p><p>其中Hello.js定义了一个简单的React组件，使用ES6语法：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by pomy on 15/11/4.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">    render()&#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;div&gt;Hello, &#123;this.props.name&#125;!&lt;/div&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>entry.js是入口文件，将一个Hello组件输出到界面：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by pomy on 15/11/4.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> Hello <span class="keyword">from</span> <span class="string">'./hello'</span>;</div><div class="line"></div><div class="line">React.render(&lt;Hello name="Nate" /&gt;, document.body);</div></pre></td></tr></table></figure><p></p><p>index.html的内容如下：<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>React Sample<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./assets/bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure><p></p><p>webpack.config.js文件通常放在项目的根目录中，它本身也是一个标准的Commonjs规范的模块：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by pomy on 15/11/4.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    <span class="attr">entry</span>: path.resolve(__dirname, <span class="string">'./src/entry.js'</span>),</div><div class="line">    <span class="attr">output</span>: &#123;</div><div class="line">        <span class="attr">path</span>: path.resolve(__dirname, <span class="string">'./assets'</span>),</div><div class="line">        <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    <span class="attr">module</span>: &#123;</div><div class="line">        <span class="attr">loaders</span>: [</div><div class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.js?$/</span>, <span class="attr">loaders</span>: [<span class="string">'babel'</span>], <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span> &#125;,</div><div class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">loader</span>: <span class="string">'babel-loader'</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>&#125;</div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    <span class="attr">resolve</span>:&#123;</div><div class="line">        <span class="attr">extensions</span>:[<span class="string">''</span>,<span class="string">'.js'</span>,<span class="string">'.json'</span>]</div><div class="line">    &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p></p><p>整个代码在 这里，clone之后，切换到react-sample目录下，在终端运行 npm i &amp;&amp; npm run build 进行打包，打包后的文件名是 bundle.js， 所在相对目录是 /assets。至此，webpack打包过程就Ok了。</p><h1 id="Webpack安装和配置"><a href="#Webpack安装和配置" class="headerlink" title="Webpack安装和配置"></a>Webpack安装和配置</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>webpack 可以作为全局的npm模块安装，也可以在当前项目中安装。<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install -g webpack</div><div class="line">npm install --save-dev webpack</div></pre></td></tr></table></figure><p></p><p>对于全局安装的webpack，直接执行此命令会默认使用当前目录的webpack.config.js作为配置文件。如果要指定另外的配置文件，可以执行：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">webpack —config webpack.custom.config.js</div></pre></td></tr></table></figure><p></p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>每个项目下都必须配置有一个 webpack.config.js ，它的作用如同常规的 gulpfile.js/Gruntfile.js ，就是一个配置项，告诉 webpack 它需要做什么。</p><p>前文说了，webpack.config.js文件通常放在项目的根目录中，它本身也是一个标准的Commonjs规范的模块。在导出的配置对象中有几个关键的参数：</p><h2 id="entry"><a href="#entry" class="headerlink" title="entry"></a>entry</h2><p>entry参数定义了打包后的入口文件，可以是个字符串或数组或者是对象；如果是数组，数组中的所有文件会打包生成一个filename文件；如果是对象，可以将不同的文件构建成不同的文件:<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">entry</span>: &#123;</div><div class="line">        <span class="attr">page1</span>: <span class="string">"./page1"</span>,</div><div class="line"></div><div class="line">        <span class="comment">//支持数组形式，将加载数组中的所有模块，但以最后一个模块作为输出</span></div><div class="line">        page2: [<span class="string">"./entry1"</span>, <span class="string">"./entry2"</span>]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">output</span>: &#123;</div><div class="line">        <span class="attr">path</span>: <span class="string">"dist/js/page"</span>,</div><div class="line">        <span class="attr">publicPath</span>: <span class="string">"/output/"</span>,</div><div class="line">        <span class="attr">filename</span>: <span class="string">"[name].bundle.js"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>该段代码最终会生成一个 page1.bundle.js 和 page2.bundle.js，并存放到 ./dist/js/page 文件夹下</p><h2 id="output"><a href="#output" class="headerlink" title="output"></a>output</h2><p>output参数是个对象，定义了输出文件的位置及名字：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">output: &#123;</div><div class="line">        <span class="attr">path</span>: <span class="string">"dist/js/page"</span>,</div><div class="line">        <span class="attr">publicPath</span>: <span class="string">"/output/"</span>,</div><div class="line">        <span class="attr">filename</span>: <span class="string">"[name].bundle.js"</span></div><div class="line">    &#125;</div></pre></td></tr></table></figure><p></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">path: 打包文件存放的绝对路径</div><div class="line">publicPath: 网站运行时的访问路径</div><div class="line">filename:打包后的文件名</div></pre></td></tr></table></figure><p>当我们在entry中定义构建多个文件时，filename可以对应的更改为[name].js用于定义不同文件构建后的名字。</p><h2 id="module"><a href="#module" class="headerlink" title="module"></a>module</h2><p>在webpack中JavaScript，CSS，LESS，TypeScript，JSX，CoffeeScript，图片等静态文件都是模块，不同模块的加载是通过模块加载器（webpack-loader）来统一管理的。loaders之间是可以串联的，一个加载器的输出可以作为下一个加载器的输入，最终返回到JavaScript上：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>: &#123;</div><div class="line">        <span class="comment">//加载器配置</span></div><div class="line">        loaders: [</div><div class="line">            <span class="comment">//.css 文件使用 style-loader 和 css-loader 来处理</span></div><div class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">loader</span>: <span class="string">'style-loader!css-loader'</span> &#125;,</div><div class="line"></div><div class="line">            <span class="comment">//.js 文件使用 jsx-loader 来编译处理</span></div><div class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">loader</span>: <span class="string">'jsx-loader?harmony'</span> &#125;,</div><div class="line"></div><div class="line">            <span class="comment">//.scss 文件使用 style-loader、css-loader 和 sass-loader 来编译处理</span></div><div class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">loader</span>: <span class="string">'style!css!sass?sourceMap'</span>&#125;,</div><div class="line"></div><div class="line">            <span class="comment">//图片文件使用 url-loader 来处理，小于8kb的直接转为base64</span></div><div class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg)$/</span>, <span class="attr">loader</span>: <span class="string">'url-loader?limit=8192'</span>&#125;</div><div class="line">        ]</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p></p><p>test项表示匹配的资源类型，loader或loaders项表示用来加载这种类型的资源的loader，loader的使用可以参考 using loaders，更多的loader可以参考 list of loaders。</p><p>！用来定义loader的串联关系，”-loader”是可以省略不写的，多个loader之间用“!”连接起来，但所有的加载器都需要通过 npm 来加载。</p><p>此外，还可以添加用来定义png、jpg这样的图片资源在小于10k时自动处理为base64图片的加载器：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg)$/</span>,<span class="attr">loader</span>: <span class="string">'url-loader?limit=10000'</span>&#125;</div></pre></td></tr></table></figure><p></p><p>给css和less还有图片添加了loader之后，我们不仅可以像在node中那样require js文件了，我们还可以require css、less甚至图片文件：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>(<span class="string">'./bootstrap.css'</span>);</div><div class="line"><span class="built_in">require</span>(<span class="string">'./myapp.less'</span>);</div><div class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>);</div><div class="line">img.src = <span class="built_in">require</span>(<span class="string">'./glyph.png'</span>);</div></pre></td></tr></table></figure><p></p><p>注意，require()还支持在资源path前面指定loader，即require(![loaders list]![source path])形式：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>(<span class="string">"!style!css!less!bootstrap/less/bootstrap.less"</span>);</div><div class="line"><span class="comment">// “bootstrap.less”这个资源会先被"less-loader"处理，</span></div><div class="line"><span class="comment">// 其结果又会被"css-loader"处理，接着是"style-loader"</span></div><div class="line"><span class="comment">// 可类比pipe操作</span></div></pre></td></tr></table></figure><p></p><p>require()时指定的loader会覆盖配置文件里对应的loader配置项。</p><h2 id="resolve"><a href="#resolve" class="headerlink" title="resolve"></a>resolve</h2><p>webpack在构建包的时候会按目录的进行文件的查找，resolve属性中的extensions数组中用于配置程序可以自行补全哪些文件后缀：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">resolve: &#123;</div><div class="line">       <span class="comment">//查找module的话从这里开始查找</span></div><div class="line">       root: <span class="string">'/pomy/github/flux-example/src'</span>, <span class="comment">//绝对路径</span></div><div class="line"></div><div class="line">       <span class="comment">//自动扩展文件后缀名，意味着我们require模块可以省略不写后缀名</span></div><div class="line">       extensions: [<span class="string">''</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>, <span class="string">'.scss'</span>],</div><div class="line"></div><div class="line">       <span class="comment">//模块别名定义，方便后续直接引用别名，无须多写长长的地址</span></div><div class="line">       alias: &#123;</div><div class="line">           <span class="attr">AppStore</span> : <span class="string">'js/stores/AppStores.js'</span>,<span class="comment">//后续直接 require('AppStore') 即可</span></div><div class="line">           ActionType : <span class="string">'js/actions/ActionType.js'</span>,</div><div class="line">           <span class="attr">AppAction</span> : <span class="string">'js/actions/AppAction.js'</span></div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure><p></p><p>然后我们想要加载一个js文件时，只要require(‘common’)就可以加载common.js文件了。</p><p>注意一下, extensions 第一个是空字符串! 对应不需要后缀的情况.</p><h2 id="plugin"><a href="#plugin" class="headerlink" title="plugin"></a>plugin</h2><p>webpack提供了[丰富的组件]用来满足不同的需求，当然我们也可以自行实现一个组件来满足自己的需求：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">     <span class="comment">//your plugins list</span></div><div class="line"> ]</div></pre></td></tr></table></figure><p></p><p>在webpack中编写js文件时，可以通过require的方式引入其他的静态资源，可通过loader对文件自动解析并打包文件。通常会将js文件打包合并，css文件会在页面的header中嵌入style的方式载入页面。但开发过程中我们并不想将样式打在脚本中，最好可以独立生成css文件，以外链的形式加载。这时extract-text-webpack-plugin插件可以帮我们达到想要的效果。需要使用npm的方式加载插件，然后参见下面的配置，就可以将js中的css文件提取，并以指定的文件名来进行加载。<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install extract-text-webpack-plugin –save-dev</div></pre></td></tr></table></figure><p></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">    <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'styles.css'</span>)</div><div class="line">]</div></pre></td></tr></table></figure><h2 id="externals"><a href="#externals" class="headerlink" title="externals"></a>externals</h2><p>当我们想在项目中require一些其他的类库或者API，而又不想让这些类库的源码被构建到运行时文件中，这在实际开发中很有必要。此时我们就可以通过配置externals参数来解决这个问题：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">externals: &#123;</div><div class="line">    <span class="string">"jquery"</span>: <span class="string">"jQuery"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>这样我们就可以放心的在项目中使用这些API了：var jQuery = require(“jquery”);</p><h2 id="context"><a href="#context" class="headerlink" title="context"></a>context</h2><p>当我们在require一个模块的时候，如果在require中包含变量，像这样：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>(<span class="string">"./mods/"</span> + name + <span class="string">".js"</span>);</div></pre></td></tr></table></figure><p></p><p>那么在编译的时候我们是不能知道具体的模块的。但这个时候，webpack也会为我们做些分析工作：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1.分析目录：<span class="string">'./mods'</span>；</div><div class="line">2.提取正则表达式：<span class="string">'/^.*\.js$/'</span>；</div></pre></td></tr></table></figure><p></p><p>于是这个时候为了更好地配合wenpack进行编译，我们可以给它指明路径，像在cake-webpack-config中所做的那样（我们在这里先忽略abcoption的作用）：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> currentBase = process.cwd();</div><div class="line"><span class="keyword">var</span> context = abcOptions.options.context ? abcOptions.options.context :</div><div class="line">path.isAbsolute(entryDir) ? entryDir : path.join(currentBase, entryDir);</div></pre></td></tr></table></figure><p></p><p>关于 webpack.config.js 更详尽的配置可以参考这里</p><h1 id="webpack常用命令"><a href="#webpack常用命令" class="headerlink" title="webpack常用命令"></a>webpack常用命令</h1><h2 id="webpack的使用通常有三种方式："><a href="#webpack的使用通常有三种方式：" class="headerlink" title="webpack的使用通常有三种方式："></a>webpack的使用通常有三种方式：</h2><p>1、命令行使用：webpack<entry.js><result.js> 其中entry.js是入口文件，result.js是打包后的输出文件<br>2、node.js API使用：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line">webpack(&#123;</div><div class="line"><span class="comment">//configuration</span></div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, stats</span>)</span>&#123;&#125;);</div></pre></td></tr></table></figure></result.js></entry.js></p><p>3、默认使用当前目录的webpack.config.js作为配置文件。如果要指定另外的配置文件，可以执行：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">webpack --config webpack.custom.config.js</div></pre></td></tr></table></figure><p></p><p>webpack 的执行也很简单，直接执行<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ webpack --display-error-details</div></pre></td></tr></table></figure><p></p><p>即可，后面的参数“–display-error-details”是推荐加上的，方便出错时能查阅更详尽的信息（比如 webpack 寻找模块的过程），从而更好定位到问题。<br>常用命令<br>webpack的使用和browserify有些类似，下面列举几个常用命令：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">webpack    <span class="comment">#最基本的启动webpack命令</span></div><div class="line">webpack -w <span class="comment">#提供watch方法，实时进行打包更新</span></div><div class="line">webpack -p <span class="comment">#对打包后的文件进行压缩</span></div><div class="line">webpack <span class="_">-d</span> <span class="comment">#提供SourceMaps，方便调试</span></div><div class="line">webpack --colors <span class="comment">#输出结果带彩色，比如：会用红色显示耗时较长的步骤</span></div><div class="line">webpack --profile <span class="comment">#输出性能数据，可以看到每一步的耗时</span></div><div class="line">webpack --display-modules <span class="comment">#默认情况下 node_modules 下的模块会被隐藏，加上这个参数可以显示这些被隐藏的模块</span></div></pre></td></tr></table></figure><p></p><p>前面的四个命令比较基础，使用频率会比较大，后面的命令主要是用来定位打包时间较长的原因，方便改进配置文件，提高打包效率。</p><h2 id="图片打包和静态资源服务器"><a href="#图片打包和静态资源服务器" class="headerlink" title="图片打包和静态资源服务器"></a>图片打包和静态资源服务器</h2><h2 id="图片打包"><a href="#图片打包" class="headerlink" title="图片打包"></a>图片打包</h2><p>webpack中对于图片的处理，可以通过url-loader来实现图片的压缩。<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">div</span><span class="selector-class">.img</span>&#123;</div><div class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(../image/xxx.jpg)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//或者</span></div><div class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.createElement(<span class="string">"img"</span>);</div><div class="line">img.src = <span class="built_in">require</span>(<span class="string">"../image/xxx.jpg"</span>);</div><div class="line"><span class="built_in">document</span>.body.appendChild(img);</div></pre></td></tr></table></figure><p>针对上面的两种使用方式，loader可以自动识别并处理。根据loader中的设置，webpack会将小于指点大小的文件转化成 base64 格式的 dataUrl，其他图片会做适当的压缩并存放在指定目录中。<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>: &#123;</div><div class="line">    &#123;</div><div class="line">      <span class="attr">test</span>: <span class="regexp">/\.(png|jpg)$/</span>,</div><div class="line">      <span class="attr">loader</span>: <span class="string">'url-loader?limit=10000&amp;name=build/[name].[ext]'</span></div><div class="line">    &#125;]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>对于上面的配置，如果图片资源小于10kb就会转化成 base64 格式的 dataUrl，其他的图片会存放在build/文件夹下。</p><h2 id="静态资源服务器"><a href="#静态资源服务器" class="headerlink" title="静态资源服务器"></a>静态资源服务器</h2><p>除了提供模块打包功能，Webpack还提供了一个基于Node.js Express框架的开发服务器，它是一个静态资源Web服务器，对于简单静态页面或者仅依赖于独立服务的前端页面，都可以直接使用这个开发服务器进行开发。在开发过程中，开发服务器会监听每一个文件的变化，进行实时打包，并且可以推送通知前端页面代码发生了变化，从而可以实现页面的自动刷新。</p><p>Webpack开发服务器需要单独安装，同样是通过npm进行：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g webpack-dev-server</div></pre></td></tr></table></figure><p></p><p>可以使用webpack-dev-server直接启动，也可以增加参数来获取更多的功能，具体配置可以参见官方文档。默认启动端口8080，通过localhost:8080/webpack-dev-server/可以访问页面，文件修改后保存时会在页面头部看到sever的状态变化，并且会进行热替换，实现页面的自动刷新。</p></div><link rel="stylesheet" href="/css/duoshuo.min.css"><style>#ds-thread #ds-reset .ds-post-button{background-color:#0097A7!important}#ds-wrapper #ds-reset .ds-icons-32{background-color:#0097A7!important}#ds-reset .ds-highlight{color:#0097A7!important}</style><div id="comments"><div class="ds-thread" data-thread-key="2016/12/07/webpack-react/" data-url="http://yoursite.com/2016/12/07/webpack-react/" data-title="Webpack与react"></div></div></div><nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col"> <a href="/2016/12/07/webpack-module/" id="post_nav-newer" class="prev-content"><button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation"> <i class="material-icons">arrow_back</i></button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; أحدث</a><div class="section-spacer"></div> <a href="/2016/12/07/zhengze/" id="post_nav-older" class="next-content">أقدم &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation"> <i class="material-icons">arrow_forward</i></button></a></nav></div></div><div class="sidebar-overlay"></div><aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation"><div id="sidebar-main"><div class="sidebar-header header-cover" style="background-image:url(/img/sidebar_header.png)"><div class="top-bar"></div> <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display:initial" data-upgraded=",MaterialButton,MaterialRipple"> <i class="material-icons">clear_all</i><span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button><div class="sidebar-image"> <img src="/img/avatar.png" alt="Mr.Hua's avatar"></div> <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">472970338@qq.com<b class="caret"></b></a></div><ul class="nav sidebar-nav"><li class="dropdown"><ul id="settings-dropdown" class="dropdown-menu"><li> <a href="#" target="_blank" title="Email Me"><i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i> Email Me</a></li></ul></li><li id="sidebar-first-li"> <a href="/" target="_self"><i class="material-icons sidebar-material-icons">home</i> الرئيسية</a></li><li class="dropdown"> <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown"><i class="material-icons sidebar-material-icons">inbox</i> أرشيف<b class="caret"></b></a><ul class="dropdown-menu"><li> <a class="sidebar_archives-link" href="/archives/2017/02/">February 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">January 2017<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">December 2016<span class="sidebar_archives-count">42</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">November 2016<span class="sidebar_archives-count">4</span></a></li></ul></li><li class="divider"></li><li> <a href="/archives" title="archives">archives</a></li><li> <a href="/tags" title="tags">tags</a></li><li> <a href="/archives">رقم المقالة <span class="sidebar-badge">57</span></a></li></ul><div class="sidebar-divider"></div><a href="https://github.com/viosey/hexo-theme-material" class="sidebar-footer-text-a" target="_blank"><div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple"> سمة - Material <span class="sidebar-badge badge-circle">i</span></div></a></div></aside><div class="toTop-wrap"> <a href="#top" class="toTop"><i class="material-icons footer_top-i">expand_less</i></a></div><footer class="mdl-mini-footer" id="bottom"><div class="mdl-mini-footer--left-section sns-list"> <a href="https://twitter.com/twitter" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image:url(/img/footer/footer_ico-twitter.png)"> <span class="visuallyhidden">Twitter</span></button></a> <a href="https://www.facebook.com/facebook" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image:url(/img/footer/footer_ico-facebook.png)"> <span class="visuallyhidden">Facebook</span></button></a> <a href="https://www.google.com/" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image:url(/img/footer/footer_ico-gplus.png)"> <span class="visuallyhidden">Google Plus</span></button></a></div><div id="copyright">Copyright&nbsp;©&nbsp;<script type="text/javascript">var fd=new Date;document.write(fd.getFullYear())</script>&nbsp;Mr.Hua's Blog</div><div class="mdl-mini-footer--right-section"><div><div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div><div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div></div></div></footer><script src="/js/highlight.min.js"></script><script src="/js/js.min.js"></script><script src="/js/nprogress.js"></script><script type="text/javascript">NProgress.configure({showSpinner:!0}),NProgress.start(),$("#nprogress .bar").css({background:"#FF4081"}),$("#nprogress .peg").css({"box-shadow":"0 0 10px #FF4081, 0 0 15px #FF4081"}),$("#nprogress .spinner-icon").css({"border-top-color":"#FF4081","border-left-color":"#FF4081"}),setTimeout(function(){NProgress.done(),$(".fade").removeClass("out")},800)</script><script type="text/javascript">var duoshuoQuery={short_name:"huajiang1989"};!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://static.duoshuo.com/embed.js",e.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script>$(window).load(function(){$(".post-toc-wrap").parent(".mdl-menu__container").css("position","fixed")})</script></main></div></body></html>